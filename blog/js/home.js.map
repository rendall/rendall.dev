{"version":3,"sources":["webpack://rendall.dev/./_src/ts/commentForm.js","webpack://rendall.dev/./_src/ts/home.js"],"names":["sendFunc","document","querySelector","emailRegex","sendMessage","fields","url","Promise","resolve","reject","params","map","f","name","encodeURI","value","join","sendReq","XMLHttpRequest","open","setRequestHeader","timeout","addEventListener","e","status","statusText","send","resetState","collection","stateName","x","dummy","item","classList","remove","preventDefault","getElementsByClassName","Array","from","querySelectorAll","invalidFields","reduce","acc","field","test","length","includes","formName","attributes","getNamedItem","console","warn","isValidField","s","i","il","arguments","r","k","a","j","jl","__spreadArrays","then","add","innerHTML","catch","error","showError","forEach","div","showInvalid","setupCommentForm"],"mappings":"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","file":"home.js","sourcesContent":["var __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nexport var setupCommentForm = function (sendFunc) {\r\n    var hasCommentForm = document.querySelector(\"form[name=contact]\") !== null;\r\n    if (!hasCommentForm)\r\n        return;\r\n    var emailRegex = /^(([^<>()\\[\\]\\\\.,:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n    var isValidField = function (field) {\r\n        switch (field.name) {\r\n            case \"name\":\r\n                return field.value != \"\";\r\n            case \"email\":\r\n                return emailRegex.test(field.value);\r\n            case \"message\":\r\n                return (field.value != \"\" &&\r\n                    field.value.length > 5 &&\r\n                    field.value.includes(\" \"));\r\n            case \"form-name\": {\r\n                var formName = document\r\n                    .querySelector(\"form\")\r\n                    .attributes.getNamedItem(\"name\").value;\r\n                if (field.value !== formName)\r\n                    console.warn(\"form-name field '\" + field.value + \"' does not equal form name '\" + formName + \"'\");\r\n                return true;\r\n            }\r\n            case \"city\":\r\n                return true;\r\n            case \"confirm\":\r\n                return true;\r\n            default: {\r\n                console.warn(\"unknown field name '\" + field.name + \"'\");\r\n                return true;\r\n            }\r\n        }\r\n    };\r\n    var sendMessage = function (fields, url) {\r\n        var sendExec = function (resolve, reject) {\r\n            var params = fields\r\n                .map(function (f) { return f.name + \"=\" + encodeURI(f.value); })\r\n                .join(\"&\");\r\n            var sendReq = new XMLHttpRequest();\r\n            var onSendComplete = function (e) {\r\n                return sendReq.status === 200\r\n                    ? resolve()\r\n                    : reject(sendReq.status + \":\" + sendReq.statusText);\r\n            };\r\n            sendReq.open(\"POST\", url);\r\n            sendReq.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\n            sendReq.timeout = 5000;\r\n            sendReq.addEventListener(\"load\", onSendComplete);\r\n            sendReq.send(params);\r\n        };\r\n        return new Promise(sendExec);\r\n    };\r\n    var showSuccess = function () {\r\n        document.querySelector(\".contain-form\").classList.add(\"is-success\");\r\n        document.querySelector(\".notify-success\").classList.add(\"is-success\");\r\n        resetError();\r\n    };\r\n    var showError = function (e) {\r\n        document.querySelector(\".notify-error\").classList.add(\"is-error\");\r\n        document.querySelector(\"#error-message\").innerHTML = e;\r\n        console.error(e);\r\n    };\r\n    var showInvalid = function (invalidFields) {\r\n        return invalidFields\r\n            .map(function (f) { return document.querySelector(\"label[for=\" + f + \"] + .notify-invalid\"); })\r\n            .forEach(function (div) { return div.classList.add(\"is-invalid\"); });\r\n    };\r\n    var resetState = function (collection, stateName, x, dummy) {\r\n        if (x === void 0) { x = 0; }\r\n        if (dummy === void 0) { dummy = null; }\r\n        return collection.item(x) === null\r\n            ? null\r\n            : resetState(collection, stateName, x + 1, collection.item(x).classList.remove(stateName));\r\n    };\r\n    var resetError = function () {\r\n        resetState(document.getElementsByClassName(\"notify-error\"), \"is-error\");\r\n        document.querySelector(\"#error-message\").innerHTML = \"\";\r\n    };\r\n    var onFormClick = function (e) {\r\n        e.preventDefault();\r\n        resetState(document.getElementsByClassName(\"notify-invalid\"), \"is-invalid\");\r\n        var fields = Array.from(document.querySelectorAll(\"form input,textarea\"));\r\n        var invalidFields = fields.reduce(function (acc, f) { return (isValidField(f) ? acc : __spreadArrays(acc, [f.name])); }, []);\r\n        var isValid = invalidFields.length === 0;\r\n        var sendMessagePromise = sendFunc === undefined ? sendMessage : sendFunc;\r\n        if (isValid)\r\n            sendMessagePromise(fields, \"/\")\r\n                .then(function () { return showSuccess(); })\r\n                .catch(function (error) { return showError(error); });\r\n        else\r\n            showInvalid(invalidFields);\r\n    };\r\n    document.querySelector(\"form button\").addEventListener(\"click\", onFormClick);\r\n    var onFormToggle = function (e) {\r\n        e.preventDefault();\r\n        var isSuccess = document\r\n            .querySelector(\".notify-success\")\r\n            .classList.contains(\"is-success\");\r\n        if (isSuccess) {\r\n            document.querySelector(\".contain-form\").classList.remove(\"is-success\");\r\n            document.querySelector(\".contain-form\").classList.add(\"is-visible\");\r\n            document.querySelector(\".notify-success\").classList.remove(\"is-success\");\r\n            resetError();\r\n        }\r\n        else\r\n            document.querySelector(\".contain-form\").classList.toggle(\"is-visible\");\r\n    };\r\n};\r\n","import { setupCommentForm } from \"./commentForm\";\r\nsetupCommentForm();\r\n"],"sourceRoot":""}